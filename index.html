<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PrysmisAI v4.0 </title>
<script src="https://cdn.jsdelivr.net/pyodide/v0.26.2/full/pyodide.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fabric@5.3.1/dist/fabric.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.2"></script>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
--bg: #020205;
--surface: #0a0a12;
--border: rgba(139, 92, 246, 0.25);
--accent: #8b5cf6;
--accent-glow: rgba(139, 92, 246, 0.5);
--secondary: #ec4899;
--text: #f1f5f9;
--text-muted: #94a3b8;
--gradient: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
-webkit-font-smoothing: antialiased;
}
body {
background-color: var(--bg);
color: var(--text);
font-family: 'Space Grotesk', sans-serif;
height: 100vh;
overflow: hidden;
display: flex;
}
.app-container {
display: flex;
width: 100%;
height: 100%;
position: relative;
}
.sidebar {
width: 280px;
background: var(--surface);
border-right: 1px solid var(--border);
display: flex;
flex-direction: column;
transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
z-index: 50;
}
.main-view {
flex: 1;
display: flex;
flex-direction: column;
position: relative;
background: radial-gradient(circle at 50% 0%, rgba(139, 92, 246, 0.08) 0%, transparent 50%);
}
header {
height: 70px;
padding: 0 40px;
display: flex;
align-items: center;
justify-content: space-between;
border-bottom: 1px solid var(--border);
backdrop-filter: blur(10px);
}
.brand {
font-size: 1.25rem;
font-weight: 700;
letter-spacing: -0.5px;
background: var(--gradient);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}
.stats-panel {
display: flex;
gap: 24px;
font-size: 0.7rem;
color: var(--text-muted);
text-transform: uppercase;
letter-spacing: 1px;
}
.chat-viewport {
flex: 1;
overflow-y: auto;
padding: 40px 0;
scroll-behavior: smooth;
}
.chat-inner {
max-width: 850px;
margin: 0 auto;
padding: 0 20px;
display: flex;
flex-direction: column;
gap: 40px;
}
.message {
display: flex;
flex-direction: column;
gap: 12px;
animation: msgReveal 0.5s cubic-bezier(0.16, 1, 0.3, 1);
}
@keyframes msgReveal {
from { opacity: 0; transform: translateY(20px); }
to { opacity: 1; transform: translateY(0); }
}
.msg-content {
max-width: 100%;
line-height: 1.6;
font-size: 0.95rem;
position: relative;
}
.ai-msg {
background: rgba(255, 255, 255, 0.02);
border: 1px solid rgba(255, 255, 255, 0.05);
border-radius: 24px;
padding: 30px;
box-shadow: 0 10px 40px rgba(0,0,0,0.2);
}
.user-msg {
align-self: flex-end;
background: rgba(139, 92, 246, 0.1);
border: 1px solid var(--border);
border-radius: 24px;
padding: 16px 24px;
max-width: 80%;
}
.thinking-wrapper {
display: flex;
flex-direction: column;
gap: 15px;
}
.node-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 10px;
margin-bottom: 20px;
}
.node {
height: 40px;
background: rgba(139, 92, 246, 0.05);
border: 1px solid var(--border);
border-radius: 8px;
display: flex;
align-items: center;
justify-content: center;
font-size: 0.65rem;
color: var(--text-muted);
position: relative;
overflow: hidden;
}
.node.active {
border-color: var(--accent);
color: var(--text);
background: rgba(139, 92, 246, 0.1);
}
.node.active::after {
content: '';
position: absolute;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.2), transparent);
animation: shimmer 1.5s infinite;
}
@keyframes shimmer {
100% { left: 100%; }
}
.input-section {
padding: 30px;
background: linear-gradient(to top, var(--bg) 60%, transparent);
}
.input-container {
max-width: 850px;
margin: 0 auto;
background: var(--surface);
border: 1px solid var(--border);
border-radius: 28px;
padding: 10px;
display: flex;
flex-direction: column;
gap: 8px;
box-shadow: 0 20px 50px rgba(0,0,0,0.5);
}
.input-row {
display: flex;
align-items: center;
gap: 10px;
}
textarea {
flex: 1;
background: transparent;
border: none;
outline: none;
color: var(--text);
padding: 12px 20px;
font-size: 1rem;
resize: none;
font-family: inherit;
max-height: 200px;
}
.btn-icon {
width: 44px;
height: 44px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s;
border: none;
background: transparent;
color: var(--text-muted);
}
.btn-icon:hover {
background: rgba(255,255,255,0.05);
color: var(--text);
}
.btn-send {
background: var(--accent);
color: white;
}
.btn-send:hover {
background: var(--secondary);
transform: scale(1.05);
box-shadow: 0 0 20px var(--accent-glow);
}
.code-container {
background: #010103;
border-radius: 12px;
margin: 15px 0;
border: 1px solid rgba(255,255,255,0.05);
overflow: hidden;
}
.code-header {
padding: 8px 16px;
background: rgba(255,255,255,0.02);
display: flex;
justify-content: space-between;
align-items: center;
border-bottom: 1px solid rgba(255,255,255,0.05);
}
pre {
padding: 20px;
font-family: 'Fira Code', monospace;
font-size: 0.85rem;
overflow-x: auto;
color: #e2e8f0;
}
.agent-badge {
padding: 2px 8px;
border-radius: 4px;
font-size: 0.6rem;
font-weight: 700;
text-transform: uppercase;
background: rgba(139, 92, 246, 0.2);
color: var(--accent);
border: 1px solid var(--border);
}
.consensus-view {
margin-top: 20px;
display: flex;
gap: 10px;
}
.consensus-item {
flex: 1;
height: 4px;
border-radius: 2px;
background: rgba(255,255,255,0.05);
position: relative;
overflow: hidden;
}
.consensus-fill {
height: 100%;
background: var(--accent);
width: 0;
transition: width 1s ease;
}
::-webkit-scrollbar { width: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 10px; }
.thinking-orbit {
width: 40px;
height: 40px;
border: 2px solid var(--border);
border-top: 2px solid var(--accent);
border-radius: 50%;
animation: spin 1s linear infinite;
margin: 0 auto;
}
@keyframes spin { 100% { transform: rotate(360deg); } }
#image-tray {
display: flex;
gap: 10px;
padding: 0 10px;
}
.tray-item {
width: 50px;
height: 50px;
border-radius: 8px;
object-fit: cover;
border: 1px solid var(--border);
}
</style>
</head>
<body>
<div class="app-container">
<aside class="sidebar" id="sidebar">
<div style="padding: 24px;">
<div class="brand" style="margin-bottom: 40px;">PRYSMIS v4.0</div>
<div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 15px; letter-spacing: 1px; font-weight: 600;">ACTIVE EXPERTS</div>
<div id="expert-list" style="display: flex; flex-direction: column; gap: 8px;"></div>
<div style="margin-top: 40px; font-size: 0.7rem; color: var(--text-muted); margin-bottom: 15px; letter-spacing: 1px; font-weight: 600;">NEURAL RECALL</div>
<div id="recall-list" style="display: flex; flex-direction: column; gap: 8px;"></div>
</div>
</aside>
<div class="main-view">
<header>
<div class="stats-panel">
<div class="stat">Backbone: <span id="backbone-id" style="color: var(--accent);">Gemma-2B-v2</span></div>
<div class="stat">Memory: <span id="mem-stat" style="color: var(--accent);">0</span> Nodes</div>
<div class="stat">Logic: <span id="logic-stat" style="color: var(--accent);">Consensus</span></div>
</div>
<div class="btn-icon" onclick="prysmis.toggleSidebar()">
<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h16"></path></svg>
</div>
</header>
<div class="chat-viewport" id="viewport">
<div class="chat-inner" id="chat-flow"></div>
</div>
<div class="input-section">
<div class="input-container">
<div id="image-tray"></div>
<div class="input-row">
<button class="btn-icon" onclick="document.getElementById('file-up').click()">
<svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 4v16m8-8H4"></path></svg>
</button>
<input type="file" id="file-up" hidden multiple accept="image/*">
<textarea id="main-input" placeholder="Initiate neural sequence..." rows="1"></textarea>
<button class="btn-icon btn-send" id="btn-submit">
<svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path></svg>
</button>
</div>
</div>
</div>
</div>
</div>
<script>
class PrysmisVectorEngine {
constructor() {
this.store = [];
this.dim = 384;
this.decayFactor = 0.99;
}
async add(content, vector, metadata = {}) {
const node = {
content,
vector,
metadata,
timestamp: Date.now(),
weight: 1.0,
id: Math.random().toString(36).substr(2, 9)
};
this.store.push(node);
this.applyDecay();
return node;
}
applyDecay() {
const now = Date.now();
this.store.forEach(node => {
const ageHours = (now - node.timestamp) / 3600000;
node.weight = Math.max(0.1, node.weight * Math.pow(this.decayFactor, ageHours));
});
this.store = this.store.sort((a,b) => b.weight - a.weight).slice(0, 1000);
}
async query(targetVec, k = 5) {
if (this.store.length === 0) return [];
const scored = this.store.map(node => ({
node,
score: this.cosineSim(targetVec, node.vector) * node.weight
}));
return scored.sort((a,b) => b.score - a.score).slice(0, k);
}
cosineSim(v1, v2) {
let dot = 0, mA = 0, mB = 0;
for(let i=0; i<v1.length; i++) {
dot += v1[i] * v2[i];
mA += v1[i] * v1[i];
mB += v2[i] * v2[i];
}
return dot / (Math.sqrt(mA) * Math.sqrt(mB) + 1e-8);
}
}
class PrysmisOrchestrator {
constructor() {
this.memory = new PrysmisVectorEngine();
this.pyodide = null;
this.vision = null;
this.embedder = null;
this.isProcessing = false;
this.uploadedImages = [];
this.experts = [
{ id: 'logic', name: 'Reasoning Engine', active: true },
{ id: 'code', name: 'Code Sandbox', active: true },
{ id: 'math', name: 'Symbolic Solver', active: true },
{ id: 'vision', name: 'Visual Cortex', active: true }
];
this.init();
}
async init() {
this.renderSidebar();
this.appendMessage('ai', 'HI welcome to PrysmisAI how may i assists you today?', 'SYSTEM');
try {
this.pyodide = await loadPyodide({ indexURL: "https://cdn.jsdelivr.net/pyodide/v0.26.2/full/" });
await this.pyodide.loadPackage(['numpy', 'sympy']);
} catch(e) { console.error("Sandbox failure"); }
try {
const { pipeline } = await import('https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.2');
this.embedder = await pipeline('feature-extraction', 'Xenova/all-MiniLM-L6-v2');
this.vision = await pipeline('image-to-text', 'Xenova/vit-gpt2-image-captioning');
} catch(e) { console.error("Neural model failure"); }
this.bindUI();
}
bindUI() {
const input = document.getElementById('main-input');
const btn = document.getElementById('btn-submit');
const file = document.getElementById('file-up');
input.addEventListener('input', () => {
input.style.height = 'auto';
input.style.height = input.scrollHeight + 'px';
});
input.addEventListener('keydown', (e) => {
if(e.key === 'Enter' && !e.shiftKey) {
e.preventDefault();
this.processInput();
}
});
btn.addEventListener('click', () => this.processInput());
file.addEventListener('change', (e) => this.handleFiles(e.target.files));
}
handleFiles(files) {
Array.from(files).forEach(f => {
const url = URL.createObjectURL(f);
this.uploadedImages.push(url);
const img = document.createElement('img');
img.src = url;
img.className = 'tray-item';
document.getElementById('image-tray').appendChild(img);
});
}
async processInput() {
const input = document.getElementById('main-input');
const query = input.value.trim();
if(!query && this.uploadedImages.length === 0) return;
if(this.isProcessing) return;
this.isProcessing = true;
this.appendMessage('user', query);
input.value = '';
input.style.height = 'auto';
const thinkingId = this.createThinkingBubble();
try {
const vector = await this.getEmbedding(query);
const contextNodes = await this.memory.query(vector, 3);
const context = contextNodes.map(c => c.node.content).join('\n');
const agents = this.spawnAgentCluster(query, this.uploadedImages);
const clusterResults = await Promise.all(agents.map(a => a.run()));
const verifiedResults = await this.verifyResults(clusterResults);
const consensus = this.mergeConsensus(verifiedResults);
const finalResponse = await this.synthesizeBackbone(query, consensus, context);
this.resolveThinkingBubble(thinkingId, finalResponse, verifiedResults);
await this.memory.add(query + " -> " + finalResponse.text, vector);
this.updateGlobalStats();
} catch(e) {
console.error(e);
this.resolveThinkingBubble(thinkingId, { text: "Neural divergence detected. System recalibrating.", agent: 'CORE-FAULT' }, []);
}
this.isProcessing = false;
this.uploadedImages = [];
document.getElementById('image-tray').innerHTML = '';
}
async getEmbedding(text) {
if(!this.embedder) return new Float32Array(384).fill(0.1);
const out = await this.embedder(text, { pooling: 'mean', normalize: true });
return Array.from(out.data);
}
spawnAgentCluster(query, images) {
const cluster = [];
cluster.push({
id: 'reasoning',
run: async () => ({ id: 'logic', data: "Analytical path: Logical decomposition of query structures complete." })
});
if(query.match(/code|python|run|execute/i)) {
cluster.push({
id: 'code-agent',
run: async () => this.executeCodeTask(query)
});
}
if(images.length > 0 && this.vision) {
cluster.push({
id: 'vision-agent',
run: async () => {
const res = await this.vision(images[0]);
return { id: 'vision', data: `Visual detection: ${res[0].generated_text}` };
}
});
}
if(query.match(/math|solve|calculate/i)) {
cluster.push({
id: 'math-agent',
run: async () => this.solveSymbolic(query)
});
}
return cluster;
}
async executeCodeTask(q) {
if(!this.pyodide) return { id: 'code', data: 'Sandbox offline' };
try {
const code = q.includes('```') ? q.split('```')[1].split('```')[0] : q;
const res = await this.pyodide.runPythonAsync(code);
return { id: 'code', data: `Execution output: ${res}`, verified: true };
} catch(e) {
return { id: 'code', data: `Runtime error: ${e.message}`, verified: false };
}
}
async solveSymbolic(q) {
if(!this.pyodide) return { id: 'math', data: 'Symbolic engine offline' };
try {
const math = q.replace(/[a-zA-Z]/g, '').trim();
const res = await this.pyodide.runPythonAsync(`import sympy; str(sympy.simplify("${math}"))`);
return { id: 'math', data: `Simplified expression: ${res}`, verified: true };
} catch(e) {
return { id: 'math', data: 'Symbolic parse failed.', verified: false };
}
}
async verifyResults(results) {
return results.map(r => ({
...r,
confidence: r.verified ? 0.98 : 0.75,
timestamp: Date.now()
}));
}
mergeConsensus(results) {
const logic = results.find(r => r.id === 'logic')?.data || '';
const code = results.find(r => r.id === 'code')?.data || '';
const vision = results.find(r => r.id === 'vision')?.data || '';
const math = results.find(r => r.id === 'math')?.data || '';
return { logic, code, vision, math, count: results.length };
}
async synthesizeBackbone(query, consensus, context) {
let responseText = "";
if(consensus.vision) responseText += `[VISUAL CONTEXT] ${consensus.vision}\n\n`;
if(consensus.code) responseText += `[EXECUTION RESULTS]\n${consensus.code}\n\n`;
if(consensus.math) responseText += `[SYMBOLIC PROOF] ${consensus.math}\n\n`;
responseText += `Based on the multi-agent consensus and my local memory retrieval, I have processed the request. The underlying logic suggests a high-probability convergence on the following synthesis: \n\n${this.getHeuristicResponse(query)}`;
return {
text: responseText,
agent: 'BACKBONE-OMEGA',
confidence: 0.94 + (Math.random() * 0.05)
};
}
getHeuristicResponse(q) {
if(q.length < 5) return "Neural state: Waiting for higher-entropy input.";
return "Integrating specific constraints into the global workspace. System confirms task completion within verified bounds.";
}
appendMessage(role, content, agent = 'USER') {
const flow = document.getElementById('chat-flow');
const div = document.createElement('div');
div.className = `message ${role === 'user' ? 'user-msg' : 'ai-msg'}`;
if(role === 'ai') {
div.innerHTML = `<div class="agent-badge" style="width: fit-content; margin-bottom: 10px;">${agent}</div><div class="msg-content">${content.replace(/\n/g, '<br>')}</div>`;
} else {
div.innerHTML = `<div class="msg-content">${content}</div>`;
}
flow.appendChild(div);
this.scroll();
return div;
}
createThinkingBubble() {
const id = 'think-' + Date.now();
const flow = document.getElementById('chat-flow');
const div = document.createElement('div');
div.id = id;
div.className = 'message ai-msg thinking-wrapper';
div.innerHTML = `
<div class="agent-badge">ORCHESTRATOR</div>
<div class="thinking-orbit"></div>
<div class="node-grid">
<div class="node active" id="${id}-n1">Memory Search</div>
<div class="node" id="${id}-n2">Agent Cluster</div>
<div class="node" id="${id}-n3">Verification</div>
<div class="node" id="${id}-n4">Consensus</div>
<div class="node" id="${id}-n5">Backbone</div>
<div class="node" id="${id}-n6">Synthesis</div>
</div>
<div style="font-size: 0.8rem; color: var(--text-muted); text-align: center;" id="${id}-status">Engaging Neural Backbone...</div>
`;
flow.appendChild(div);
this.scroll();
this.animateThinking(id);
return id;
}
animateThinking(id) {
const stages = [
{ node: 'n1', status: 'HNSW Graph Traversing...' },
{ node: 'n2', status: 'Spawning Multi-Agent instances...' },
{ node: 'n3', status: 'Executing Programmatic Verification...' },
{ node: 'n4', status: 'Consolidating consensus weighting...' },
{ node: 'n5', status: 'Synthesizing Backbone response...' },
{ node: 'n6', status: 'Final neural fusion...' }
];
let i = 0;
const interval = setInterval(() => {
if(i >= stages.length) { clearInterval(interval); return; }
const node = document.getElementById(`${id}-${stages[i].node}`);
if(node) node.classList.add('active');
const status = document.getElementById(`${id}-status`);
if(status) status.innerText = stages[i].status;
i++;
}, 600);
}
resolveThinkingBubble(id, final, agents) {
const el = document.getElementById(id);
if(!el) return;
el.classList.remove('thinking-wrapper');
el.innerHTML = `
<div class="agent-badge">${final.agent}</div>
<div class="msg-content" style="margin-top: 10px;">${final.text.replace(/\n/g, '<br>')}</div>
<div class="consensus-view">
${agents.map(a => `<div class="consensus-item"><div class="consensus-fill" style="width: ${a.confidence * 100}%"></div></div>`).join('')}
</div>
<div style="font-size: 0.65rem; color: var(--text-muted); margin-top: 10px; display: flex; justify-content: space-between;">
<span>Neural Confidence: ${(final.confidence * 100).toFixed(2)}%</span>
<span>Agents: ${agents.length}</span>
</div>
`;
this.scroll();
}
scroll() {
const v = document.getElementById('viewport');
v.scrollTop = v.scrollHeight;
}
updateGlobalStats() {
document.getElementById('mem-stat').innerText = this.memory.store.length;
const recallList = document.getElementById('recall-list');
recallList.innerHTML = this.memory.store.slice(-3).map(n => `
<div style="font-size: 0.65rem; padding: 8px; background: rgba(255,255,255,0.02); border: 1px solid var(--border); border-radius: 4px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
${n.content}
</div>
`).join('');
}
renderSidebar() {
const el = document.getElementById('expert-list');
el.innerHTML = this.experts.map(e => `
<div style="display: flex; align-items: center; gap: 10px; font-size: 0.75rem; color: var(--text-muted);">
<div style="width: 6px; height: 6px; border-radius: 50%; background: ${e.active ? '#10b981' : '#ef4444'};"></div>
${e.name}
</div>
`).join('');
}
toggleSidebar() {
const s = document.getElementById('sidebar');
s.style.width = s.style.width === '0px' ? '280px' : '0px';
}
}
const prysmis = new PrysmisOrchestrator();
window.prysmis = prysmis;
</script>
</body>
</html>
